---
layout: post   	
catalog: true 	
tags:
    - Linux
---



**Linux一般有4个主要部分：内核、shell、文件系统和应用程序。内核、shell和文件系统一起形成了基本的操作系统结构**

## Shell

* Bash是Linux系统中默认使用的shell程序，位于`/bin/bash`
* 用户登录Linux系统时，自动加载一个shell程序
* Linux系统中运行的特殊程序
* Shell是介于用户和内核间的

## 命令分类

| 内部命令                                         | 外部命令                                |
| ------------------------------------------------ | --------------------------------------- |
| 集成于shell解释器内部的指令，称为`Built-in`      | Linux系统中完成一定功能的脚本文件       |
| 属于shell的一部分                                | 属于shell解释器之外的命令               |
| 加载解释器时，这些命令也自动加入内存，可直接使用 | 必须知道其对应的位置，由shell加载后执行 |
| 没有单独对应的系统文件                           | 每个外部命令对应系统中的一个文件        |

## 命令格式

* 格式

```
命令字 [选项] [参数]
```

**注**：Linux命令中，对大小写敏感

* 选项

```
选项：
短格式选项 用 - 引导，如 -h
长格式选项 用 -- 引导，如 --help
-help会被认为是 -h -e -l -p
```

* Bash快捷键

```
Tab键 --> 补全
\    --> 强制换行符
Ctrl + u  --> 从光标所在处删除至行首
Ctrl + k --> 从光标所在处删除至行尾
Ctrl + l --> 清屏
Ctrl + c --> 终止当前程序
q --> 退出
```

* Linux在终端中直接选中字符，无需其他操作即可完成复制



## 帮助命令

* help命令

查看命令的简单说明

* man命令

查询命令的详细说明

* info命令

更加详细的说明

* whereis命令

查看文件路径

## 文件及目录管理

文件或目录的创建、删除、查询、移动，文件查询是重点

**注意**和通配符、管道符搭配使用

### 创建和删除

* 创建文件：touch

```
touch filename
当文件存在时，touch 命令就是更新文件时间戳
```

- 创建目录：mkdir

```
-p 创建多层目录
```

- 删除文件：rm

```
-r 删除目录及所有子目录下的所有文件
-f 强制删除，不提醒
```

- 移动目录：mv

```
可以改名，即新文件名覆盖到之前文件的位置
```

- 复制：cp 

```
-r 复制目录及所有子目录下的所有文件
-p 复制时保持源文件的权限、属主及时间标记等属性不变
-f 强制复制，不提醒
```

- 链接文件（软链接类似快捷方式）：ln

```
ln -s 源文件路径 链接路径
```




### 目录切换

- 找到文件/目录位置：`cd`
- 切换到上一个工作目录： `cd -`
- 进入当前目录：`cd ./`
- 进入上一级目录：`cd ../`
- 切换到home目录： `cd或cd ~`
- 根目录：`/`
- 显示当前完整路径: `pwd`

### 列出目录项

- 显示目录下的文件 `ls`

**注**：Linux中文件名前加`.`即可隐藏文件

```
-l 显示目录下的详细信息
-h  
-a 
-A 显示目录下所有文件，包括隐藏文件
-d 只看目录本身的信息
```

* 结合通配符

```
? 任意一个字符
* 任意多个字符
```

### 别名

`alias 别名='命令'`

### 查看目录占用空间

查看当前目录所占空间大小：`du -sh`

### 查找目录及文件

* 查看外部命令对应的文件所在的位置：which

```
which 外部命令
```

* 查找：find

```
find 查找范围 查找条件
查找条件：
-name 按文件名查
-size 按文件大小查
-user 按用户查找
-type 按类型
-time 
```

### 查看文件内容

* 显示文件内容：cat

```
-n 显示行号
-b 不显示空行
```

* 分页显示文件内容：more

```
Enter键向下滚动
空格键翻页
q退出
```

* 与more类似，但功能更多：less

```
/ 键查找内容
n 下一个内容
N 上一个内容
```

* 显示文件倒数第n行：tail

```
-f 动态监视文件末行内容
-n n是行数
```

* 显示文件第n行：head

```
-n n是行数
```

* 统计文件中单词数：wc

```
-l 统计行数
-w 统计单词个数
-c 统计字节数
```

* grep

```

```

* 用vim编辑器查看：vi file

```

```

* 查看两个文件间的差别：diff file1 file2

### 查找文件内容

* egrep

  查找并将符合条件的内容输出到一个文本


### 文件与目录的权限

- 改变文件的拥有者 chown
- 改变文件读、写、执行等属性 chmod
- 递归子目录修改： chown -R tuxapp source/
- 增加脚本可执行权限： chmod a+x myscript

### 设置环境变量

启动帐号后自动执行的是 文件为 `.profile`，然后通过这个文件可设置自己的环境变量`$PATH`

* 每个路径用冒号分隔
* 添加环境变量

该方法只在当前有效，重启后无效`export PATH=$PATH:路径`

写入配置文件`/etc/profile`

## 文本处理

### find命令

* 文件查找

  find [目录] -name [文件名|支持正则表达式|通配符]

![](F:\笔记\博客\文章图片\find.jpg)

- 按类型搜索

  find . -type d -print  //只列出所有目录

  注：-type f 文件 / l 符号链接 / d 目录

- 按用户查找:

  find . -type f -user weber -print  // 找用户weber所拥有的文件

### file命令

可以检查文件具体类型

### {}

{}是一个特殊的字符串，对于每一个匹配的文件，{}会被替换成相应的文件名；

### -print的定界符

* 默认使用’\n’作为文件的定界符；

* -print0 使用’\0’作为文件的定界符，这样就可以搜索包含空格的文件；

### sort排序

- -n 按数字进行排序
- -r 逆序排序
- -k N 指定按第N列排序

### tr进行文本替换

* -d 删除字符

* -c 获取字符

* -s 压缩多余字符

* 字符1 字符2 用字符1替换字符2

  ![](F:\笔记\博客\文章图片\tr.jpg)

## 磁盘管理

### 查看磁盘空间

* 查看磁盘空间利用大小：df -h
* 查看当前目录所占空间大小：`du -sh`

### 打包和压缩

在linux中打包和压缩是分两步来实现的，先打包后压缩

tar命令支持通配符和正则语法

#### 打包

打包是将多个文件归并到一个文件：

```
tar -cvf etc.tar 1.txt 2.txt
//etc.tar是打包好后的文件名，后面加上要打包的文件名1.txt和2.txt
```

- -c :打包选项
- -v :显示打包进度
- -f :使用档案文件

#### 压缩

gzip demo.txt，生成 demo.txt.gz

### 解包和解压缩

#### 解包

tar -xvf demo.tar

tar解压参数说明：

- -zxvf  解压gz文件
- -jxvf  解压bz2文件
- -Jxvf  解压xz文件

#### 解压缩 

* gunzip

* bzip

## 进程管理

在linux环境中，任何事物都是文件，设备是文件，目录是文件，甚至sockets也是文件

### 查询进程

查询正在运行的进程信息

```
ps -ef
```

以完整的格式显示所有的进程

```
ps -ajx
```

显示进程信息，并实时更新

```
top
```

查询进程ID（适合只记得部分进程字段）

```
pgrep 查找进程
如：
pgrep -l re  //查询进程名中含有re的进程

```

查看端口占用的进程状态：

```
lsof -i:3306
```



查看用户username的进程所打开的文件

```
lsof -u username
```

查询指定的进程ID(23295)打开的文件：

```
lsof -p 23295
```

### 终止进程

杀死指定PID的进程 (PID为Process ID)

```
kill PID
```

### 进程监控

top

### 分析线程栈

pmap



## 性能监控

vmstat

watch

sar

## 网络工具

netstat 命令用于显示各种网络相关信息，如网络连接，路由表，接口状态 (Interface Statistics)，masquerade 连接，多播成员 (Multicast Memberships) 等等。

### 查询网络服务和端口

列出所有端口 (包括监听和未监听的):

```
netstat -a
```

列出所有 tcp 端口:

```
netstat -at
```



列出所有有监听的服务状态:

```
netstat -l
```

lsof（list open files）是一个列出当前系统打开文件的工具

查询使用7902端口的进程的PID

```
lsof -i:7902
```

### 网络路由

查看路由状态:

```
route -n
```

发送ping包到地址IP:

```
ping IP
```

探测前往地址IP的路由路径:

```
traceroute IP
```

DNS查询，寻找域名domain对应的IP:

```
host domain
```

反向DNS查询:

```
host IP
```

## 用户管理

### 用户

#### 添加用户

```
useradd -m username
```

该命令为用户创建相应的帐号和用户目录/home/username；

设置密码：

```
passwd username
```

#### 删除用户

```
userdel -r username
```

不带选项使用 userdel，只会删除用户。用户的家目录将仍会在/home目录下。要完全的删除用户信息，使用-r选项；

#### 帐号切换

```
su username
```

### 用户的组

#### 将用户加入到组

默认情况下，添加用户操作也会相应的增加一个同名的组，用户属于同名组； 查看当前用户所属的组:

```
groups
```

#### 一个用户可以属于多个组，将用户加入到组:

```
usermod -G groupNmame username
```

#### 加入到新的组，并从原有的组中除去:

```
usermod -g groupName username
```

#### 查看系统所有组

系统的所有用户及所有组信息分别记录在两个文件中：/etc/passwd , /etc/group 默认情况下这两个文件对所有用户可读：

* 查看所有用户及权限:

  ```
  more /etc/passwd
  ```

* 查看所有的用户组及权限:

  ```
  more /etc/group
  ```

### 用户权限

使用`ls -l`可查看文件的属性

更改读写权限有两种方法，一种是字母方式，一种是数字方式

#### 字母方式

```
chmod userMark (+|-) PermissionsMark  //+号表示添加权限，-号表示删除权限
```

* userMark取值：

- u：当前用户
- g：同组用户
- o：其它用户
- a：所有用户

* PermissionsMark取值：

- r：读
- w：写
- x：执行
- s：sudo权限

```bash
如：chmod g+w blogs        对组用户给文件blogs增加可写权限
如：chmod u+r 1.txt 修改1.txt文件给当前用户添加可读权限
```

#### 数字方式

r=4、w=2、x=1、-=0

有权限表示为`1`,无权限表示为`0`，共9个二进制位，每3个为一位，所以组成3个十进制数，这一组十进制数即可表示相应权限

```bash
如：chmod 764 1.sh
7=4+2+1
6=4+2
```

* 参数

```
chmod -R 修改指定目录及其子目录的所有文件的权限
```



## 文本编辑工具vim

### 使用

#### 初级使用

* 命令模式（默认）

  按 `i` 键进入插入模式
* 插入模式

  编辑结束后按Esc键退出插入模式，输入`:`进入末行状态，再输入`wq` 退出vi

  或编辑结束后按Esc键退出插入模式，使用快捷键`shitf+zz`退出vi

#### 显示代码行数

进入末行状态后，输入set number

#### 跳转到指定位置

在命令模式下

* 跳转到指定行：`行号 + G`
* 跳转到最后一行：`GG`
* 跳转到一行的末尾：`$`
* 跳转到一行的起始位：`^`

#### 删除内容

在命令模式下

* 删除一行：`dd`
* 撤销删除：`u`
* 删除选中：`v+d`

#### 复制粘贴剪切

命令状态下

* 复制：`yy`
* 粘贴：`p`
* 剪切：`x`

#### 搜索

命令状态下

* 输入`/+要搜索的字符串`

#### 自动缩进

命令状态下，在要缩进的代码开头输入，代码行数，最后再输入`==`

#### 自动补全

在插入状态下，输入`ctrl + p`



## Linux用户

每个用户都有一个home目录

### 两种类型

#### 超级用户（root用户）

* 登录提示符为`#`
* 只能有一个root用户
* home目录为
  *  /root
* `~`代表home目录
* pwd查看当前操作路径
* 用户名root不可修改，可修改密码，
  * 命令passwd

#### 普通用户

* 登录提示符为 $
* 切换用户类型
  * （switch user）su 用户名 
* 可以有多个用户
* home目录为
  * /home/用户名



## Linux目录结构

### 介绍

Windows是通过“某个硬盘-硬盘上的某个分区-分区上的特定文件系统-特定文件系统中的文件”这样的顺序来访问到一个文件的

Linux系统是通过“虚拟文件系统-硬盘-硬盘上的分区-分区上的特定文件系统-特定文件系统中的文件”这样的顺序来访问一个文件的

整个“虚拟文件系统”的组织结构，都是随着每次系统的启动自动在内存中建立好了的，根本就不需要硬盘

在Linux系统中，主要两个东西：“虚拟文件系统”中的文件和Linux操作系统内核本身

Linux把除了它本身(Linux操作系统内核以外的一切事物都看作是在“虚拟文件系统”中的文件了。无论是键盘，鼠标，数据，程序，CPU，内存，网卡……无论是硬件、软件、数据还是内存中的东西，我们都可以在虚拟文件系统中的相应子目录对他们进行访问和操作

在Linux文件系统中的每一个子目录都有特定的目的和用途。一般都是根据FHS标准定义一个正式的文件系统结构的，这个标准规定了哪些目录应该哪些作用

### 常用的重要目录

* `/`根目录

* `/boot`引导程序，内核等存放的目录

* `/sbin`超级用户可以使用的命令的存放目录

这个目录和`/usr/sbin`，`/usr/X11R6/sbin`或`/usr/local/sbin`等目录是相似的，我们要记住，凡是目录sbin中包含的都是root权限才能执行的

* `/bin`普通用户可以使用的命令的存放目录

作为基础系统所需要的最基础的命令就是放在这里，比如ls、cp、mkdir等命令;类似的目录还`/usr/bin`，`/usr/local/bin`等等

* `/lib`根目录下的所程序的共享库目录

此目录下包含系统引导和在根用户执行命令时候所必需用到的共享库

* `/dev`设备文件目录

在Linux中设备都是以文件形式出现，这里的设备可以是硬盘，键盘，鼠标，网卡，终端，等设备，通过访问这些文件可以访问到相应的设备。设备文件可以使用mknod命令来创建

* `/home`普通用户的家目录

通常而言，系统的每个用户都自己的家目录，目录以用户名作为名字存放在`/home`下面（例如quietheart用户，其家目录的名字为`/home/quietheart`）。该目录中保存了绝大多数的用户文件(用户自己的配置文件，定制文件，文档，数据等)，root用户除外

* `/root`系统管理员的家目录
* `/etc`全局的配置文件存放目录

一般来说一个程序启动，如果需要读取一些配置文件的话，它会首先读取当前用户家目录的配置文件，如果存在就使用，如果不存在它就到/etc下读取全局的配置文件进而启动程序

* `/usr`这个目录中包含了命令库文件和在通常操作中不会修改的文件

安装程序的时候，默认就是安装在此文件内部某个子文件夹内。输入命令后系统默认执行`/usr/bin`下的程序（当然，前提是这个目录的路径已经被添加到了系统的环境变量中）。此目录通常也会挂载一个独立的磁盘分区，它应保存共享只读类文件，这样它可以被运行Linux的不同主机挂载。

* `/usr/lib`目标库文件，这里存放的文件应该是`/bin`目录下程序所需要的库文件的存放地，也不排除一些例外的情况
* `/usr/bin`

此目录相当于根文件系统下的对应目录`/bin`，非启动系统，非修复系统以及非本地安装的程序一般都放在此目录下。

* `/usr/sbin`

此目录相当于根文件系统下的对应目录`/sbin`，保存系统管理程序的二进制文件，并且这些文件不是系统启动或文件系统挂载 `/usr `目录或修复系统所必需的

* `/usr/share`存放共享文件的目录
* `/usr/include`C程序语言编译使用的头文件
* `/usr/local`安装本地程序的一般默认路径

这个目录存放的内容，一般都是我们后来自己安装的软件的默认路径，如果择了这个默认路径作为软件的安装路径，被安装的软件的所文件都限制在这个目录中，其中的子目录就相应于根目录的子目录。

* `/proc`特殊文件目录

这个目录采用一种特殊的文件系统格式(proc格式，内核支持这种格式。其中包含了全部虚拟文件。它们并不保存在磁盘中，也不占据磁盘空间（尽管命令ls -c会显示它们的大小）。当您查看它们时，您实际上看到的是内存里的信息，这些文件助于我们了解系统内部信息

* `/opt`可择的文件目录

这个目录的作用一点类似/usr/local

* `/mnt`临时挂载目录

这个目录一般是用于存放挂载储存设备的挂载目录的，比如磁盘，光驱，网络文件系统等，当我们需要挂载某个磁盘设备的时候，可以把磁盘设备挂载到这个目录上去，这样我们可以直接通过访问这个目录来访问那个磁盘了

如果Linux是虚拟机，且开启了共享文件夹，则这个位置就是共享文件的存放处

* `/media`挂载的媒体设备目录

比如我们插入一个U盘，我们一般会发现，Linux自动在这个目录下建立一个disk目录，然后把U盘挂载到这个disk目录上，通过访问这个disk来访问U盘

### 与Windows目录的对应关系

* `/usr = C:\Windows\`
* `/usr/lib = C:\Windows\System32\`
* `/usr/local = C:\Program Files\`
* `/opt = D: \Software\`

