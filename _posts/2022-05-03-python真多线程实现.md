---
layout: post   	
catalog: true 	
tags:
    - python
---



**通过调用C函数库**

```c
#include <stdio.h>
#include <stdlib.h>
#include <pthread.h>
#include <unistd.h>


void* myThread(void *arg)
{
    while (1);
}

void createThread(void)
{
    int err;
    pthread_t tid;
    err = pthread_create(&tid, NULL, myThread, NULL);
    if (err != 0) {
        printf("create thread failed!\n");
        return;
        }
return;
}
```

**编译成动态库**

```powershell
gcc -fPIC -shared -o libfoo.so foo.c
```

**在Python中调用，实现真正的多线程**

```python
#-*- coding=utf-8 -*-
from ctypes import *
import time

lib = CDLL("./libfoo.so", RTLD_GLOBAL)
create_thread = lib.createThread
#create_thread.argtypes = [c_void]
#create_thread.restype = c_void

if __name__ == '__main__':
    create_thread()
    create_thread()
    while True:
        print 'I am in main thread!'
        time.sleep(2)
```