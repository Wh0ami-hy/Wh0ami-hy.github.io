---
layout: post   	
catalog: true 	
tags:
    - Docker
---


使用Docker Compose 实现部署一个项目

# 1. 创建项目文件夹

```
cd /root
mkdir company-project
cd company-project
# project-nginx 目录下存放dockerfile、nginx.conf、前端编译后的文件dist
mkdir project-nginx
# 存放后端打包的jar
mkdir project-java
```
# 2. 创建Dockerfile

整理项目用到的程序，如nginx、jdk、tomcat等，数据库redis、mysql不建议使用docker
## 2.1. Python Web 应用

以下是一个完整的 Dockerfile 示例，用于构建一个 Python Web 应用：

```
# 使用官方 Python 基础镜像
FROM python:3.9-slim

# 安装系统依赖
RUN apt-get update && apt-get install -y --no-install-recommends gcc python3-dev

# 创建应用程序目录
WORKDIR /app

# 复制 requirements.txt 文件
COPY requirements.txt .

# 安装 Python 依赖
RUN pip3 install --no-cache-dir -r requirements.txt

# 复制应用程序代码
COPY . .

# 暴露应用程序监听的端口
EXPOSE 8000

# 定义启动命令
CMD ["python3", "app.py"]
```

## 2.2. Node.js 应用

以下是一个完整的 Dockerfile 示例，用于构建一个 Node.js 应用：

```
# 使用官方 Node.js 基础镜像
FROM node:14-alpine

# 创建应用程序目录
WORKDIR /app

# 复制 package.json 和 package-lock.json 文件
COPY package*.json .

# 安装 Node.js 依赖
RUN npm install

# 复制应用程序代码
COPY . .

# 暴露应用程序监听的端口
EXPOSE 3000

# 定义启动命令
CMD ["npm", "start"]
```

## 2.3. Java Web 应用

以下是一个完整的 Dockerfile 示例，用于构建一个 Java Web 应用：

```
# 使用官方 OpenJDK 基础镜像
FROM openjdk:15-jdk

# 创建应用程序目录
WORKDIR /app

# 复制应用程序 JAR 文件
COPY myapp.jar myapp.jar

# 暴露应用程序监听的端口
EXPOSE 8080

# 定义启动命令
CMD ["java", "-jar", "myapp.jar"]
```

## 2.4. Nginx Web 服务器

以下是一个完整的 Dockerfile 示例，用于构建一个 Nginx Web 服务器：

```
# 使用官方 Nginx 基础镜像
FROM nginx:latest

# 复制自定义配置文件
COPY nginx.conf /etc/nginx/conf.d/default.conf

# 暴露 Nginx 监听的端口
EXPOSE 80

# 启动 Nginx 服务
CMD ["nginx", "-g", "daemon off;"]
```
# 3. 部署flask

只涉及一个容器不需要使用Docker Compose

在服务器中创建一个code目录

从GitHub上克隆项目到code目录

打开项目文件夹，在该目录下创建文本文件 dockerfile，内容如下
```txt
# 指定基础镜像
FROM python:3.8.10
# 设置工作目录
WORKDIR /app
# 将项目下的requirements.txt文件复制到 /app目录
COPY ./requirements.txt .
# 执行命令pip install --no-cache-dir -r requirements.txt 安装项目依赖
RUN pip install --no-cache-dir -r requirements.txt
# 将Flask 项目复制到容器中的 /app 目录
COPY . .
# 容器向外暴露5000端口
EXPOSE 5000
# 在容器启动时运行 app.py 脚本
CMD [ "python", "app.py" ]
```

在dockerfile所在目录下，使用命令`docker build -t webshell_ids .`构建镜像

到此镜像定制完毕，之后运行该镜像即可启动项目