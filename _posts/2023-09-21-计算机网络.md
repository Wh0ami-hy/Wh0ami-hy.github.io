---
layout: post   	
catalog: true 	
tags:
    - 408
---


# 1. 网络访问全过程

从数据链路层开始描述

当浏览器发送请求并接收响应时，涉及到的网络路径和设备以及相关的网络协议如下：

1. DNS解析：
	
	当用户在浏览器中输入URL时，浏览器首先会提取主机名（例如www.example.com）。浏览器会向本地DNS服务器发送DNS查询请求，该服务器通常由互联网服务提供商（ISP）提供。

   - 浏览器通过使用本地DNS服务器的IP地址，构建一个DNS查询报文。
   - DNS查询报文使用域名系统协议（DNS）进行封装，并发送到本地DNS服务器。

2. 路由和网关：

	当DNS查询报文离开用户的计算机后，它将通过网络到达ISP的网络。在这个过程中，报文将通过多个路由器传输，这些路由器根据IP地址将报文从一个网络节点转发到另一个网络节点。路由器根据路由表来确定最佳路径。

   - 报文经过本地计算机的网卡，通过本地网络连接到ISP的网络。
   - 报文通过多个路由器转发，直到到达ISP的网络。

   如果用户的计算机与互联网之间有一个网关（例如，路由器），则报文会通过该网关进行转发。

3. ISP的DNS服务器：
	
	一旦DNS查询报文到达ISP的网络，它将被转发到ISP的DNS服务器。该服务器负责解析域名并返回与之相关的IP地址。

   a. DNS查询报文到达ISP的DNS服务器。
   b. 服务器查找与请求的域名相关联的IP地址。
   c. DNS服务器将IP地址作为响应，封装在DNS响应报文中发送回用户计算机。

4. 建立连接：

	一旦浏览器获得目标服务器的IP地址，它将使用HTTP（或HTTPS）协议与目标服务器建立连接。在建立连接之前，浏览器和服务器之间需要进行一些握手过程。

   a. 浏览器通过使用目标服务器的IP地址，构建一个TCP连接请求报文。
   b. 报文通过网络传输到目标服务器。

5. 服务器处理请求：

	目标服务器接收到浏览器发送的请求后，将根据请求的URL和其他相关信息（如请求头）来处理请求。服务器可能会执行一些处理逻辑，如读取文件、查询数据库等。

6. 返回响应：

	服务器处理完请求后，将生成一个HTTP响应报文，并将其发送回浏览器。

   a. 服务器将生成一个HTTP响应报文，其中包含响应状态码、响应头和响应体。
   b. 响应报文通过网络传输回用户的计算机。

7. 渲染页面：

	一旦浏览器接收到服务器发送的响应，它将解析响应报文，并根据其中的HTML、CSS和JavaScript等资源渲染页面。

# 2. 总结

1. 在互联网的交付有两种，一是在本网络直接交付不用经过路由器，另一种是和其他网络的间接交付，至少经过一个路由器，但最后一次一定是直接交付
2. 路由器根据目的主机所连接的网络号来转发分组。一个路由器至少连接到两个网络，所以一个路由器至少应当有两个不同的 IP 地址



# 3. 五层体系结构

在计算机网络中，常用的五层体系结构是指OSI（Open Systems Interconnection）参考模型，它将网络通信划分为五个层次。以下是每个层次涉及的设备、功能和协议的详细说明：

1. 物理层（Physical Layer）：
  
    - 设备：集线器（Hub）、中继器（Repeater）、传输介质（如双绞线、光纤）等。
    - 功能：负责传输原始的比特流，将数据从一个节点传输到另一个节点。
    - 协议：Ethernet、ATM（Asynchronous Transfer Mode）等。
2. 数据链路层（Data Link Layer）：
  
    - 设备：网桥（Bridge）、交换机（Switch）等。
    - 功能：负责将物理层传输的数据分割成数据帧，并在相邻节点之间传输。
    - 协议：MAC（Media Access Control）地址、以太网（Ethernet）、PPP（Point-to-Point Protocol）等。
    - 交换机：用于在局域网（LAN）中转发数据帧，交换机会维护一个MAC地址表，根据MAC地址，将数据包从一个接口转发到另一个接口，实现主机之间的直接通信
    - 网桥：网桥的主要功能是将网络分割成多个碰撞域，当一个数据帧到达网桥时，网桥会检查数据帧中的源MAC地址，并将该地址添加到网桥的转发表中。然后，网桥会查找目标MAC地址在转发表中的条目，如果找到匹配项，则将数据帧转发到相应的接口，从而使数据帧只在目标网络段中传输，而不会被广播到整个网络中，当网桥接收到一个未知的目标MAC地址时，它会将数据帧广播到所有的接口，以便学习到该地址所在的网络段，并将该地址添加到转发表中，以后的数据帧可以直接转发到目标网络段。
1. 网络层（Network Layer）：
  
    - 设备：路由器（Router）、三层交换机（Layer 3 Switch）等。
    - 功能：负责将数据从源主机路由到目标主机，实现不同网络之间的通信。
    - 协议：IP（Internet Protocol）、ICMP（Internet Control Message Protocol）、ARP（Address Resolution Protocol）等。
4. 传输层（Transport Layer）：
  
    - 设备：网关（Gateway）。
    - 功能：提供端到端的可靠数据传输，为应用层提供数据分段和重新组装功能。
    - 协议：TCP（Transmission Control Protocol）、UDP（User Datagram Protocol）等。
5. 应用层（Application Layer）：
  
    - 设备：Web服务器、DNS服务器、电子邮件服务器等。
    - 功能：为用户提供各种网络应用服务，如Web浏览、文件传输、电子邮件等。
    - 协议：HTTP（Hypertext Transfer Protocol）、FTP（File Transfer Protocol）、SMTP（Simple Mail Transfer Protocol）等。

# 4. 各设备的作用

路由器用于连接不同局域网之间的计算机，而交换机用于同一个局域网内的计算机互联