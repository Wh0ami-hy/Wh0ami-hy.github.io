



# 1. Nginx 简介

**Nginx (engine x)** 是一款轻量级的 Web 服务器 、反向代理服务器及电子邮件（IMAP/POP3）代理服务器

# 2. 静态站点

需要配置静态站点，即 html 文件和一堆静态资源

举例来说：如果所有的静态资源都放在了 `/app/dist` 目录下，我们只需要在 `nginx.conf` 中指定首页以及这个站点的 host 即可。

```nginx
worker_processes 1; events { worker_connections 1024; } http { include mime.types; default_type application/octet-stream; sendfile on; keepalive_timeout 65; gzip on; gzip_types text/plain application/x-javascript text/css application/xml text/javascript application/javascript image/jpeg image/gif image/png; gzip_vary on; server { listen 80; server_name static.zp.cn; location / { root /app/dist; index index.html; #转发任何请求到 index.html } } }
```

然后，添加 HOST：

`127.0.0.1 static.zp.cn`

此时，在本地浏览器访问 static.zp.cn ，就可以访问静态站点了。

# 3. 网站有多个 webapp 的配置

假如 `www.helloworld.com`站点有好几个 webapp，product（产品）、admin（用户中心）。访问这些应用的方式通过上下文(context)来进行区分

`www.helloworld.com/product/`

`www.helloworld.com/admin/`

http 的默认端口号是 80，如果在一台服务器上同时启动这几个 webapp 应用，都用 80 端口，肯定是不成的。所以，这几个应用需要分别绑定不同的端口号。

那么，问题来了，用户在实际访问 `www.helloworld.com`站点时，访问不同 webapp，总不会还带着对应的端口号去访问吧。所以，需要用到反向代理来做处理。

```nginx
http { #此处省略一些基本配置 upstream product_server{ server www.helloworld.com:8081; } upstream admin_server{ server www.helloworld.com:8082; } upstream finance_server{ server www.helloworld.com:8083; } server { #此处省略一些基本配置 #默认指向product的server location / { proxy_pass http://product_server; } location /product/{ proxy_pass http://product_server; } location /admin/ { proxy_pass http://admin_server; } location /finance/ { proxy_pass http://finance_server; } } }
```

# 4. 搭建文件服务器

适用于团队需要归档一些数据或资料

Nginx 中的配置要点：

- 将 autoindex 开启可以显示目录，默认不开启。
- 将 autoindex_exact_size 开启可以显示文件的大小。
- 将 autoindex_localtime 开启可以显示文件的修改时间。
- root 用来设置开放为文件服务的根路径。
- charset 设置为 `charset utf-8,gbk;`，可以避免中文乱码问题（windows 服务器下设置后，依然乱码）。